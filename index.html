<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Auth System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg: #0f172a;
      --card-bg: #020617;
      --accent: #3b82f6;
      --accent-soft: rgba(59, 130, 246, 0.15);
      --border: #1f2937;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --danger: #f97373;
      --success: #4ade80;
      --radius-xl: 18px;
      --radius-md: 10px;
      --shadow-soft: 0 18px 40px rgba(15, 23, 42, 0.75);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top left, #1d4ed8, #020617 55%),
        radial-gradient(circle at bottom right, #0369a1, #020617 70%);
      color: var(--text);
      padding: 24px;
    }

    .app {
      width: 100%;
      max-width: 960px;
      background: linear-gradient(145deg, #020617, #020617ee);
      border-radius: 24px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148, 163, 184, 0.2);
      padding: 26px 26px 22px;
      backdrop-filter: blur(18px);
    }

    .app-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
      margin-bottom: 20px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .brand-logo {
      width: 38px;
      height: 38px;
      border-radius: 14px;
      background: radial-gradient(circle at 20% 0%, #60a5fa, #1e40af);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 25px rgba(37, 99, 235, 0.6);
      font-size: 20px;
      font-weight: 700;
      color: white;
    }

    .brand-text-title {
      font-size: 18px;
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    .brand-text-sub {
      font-size: 12px;
      color: var(--muted);
    }

    .badge {
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(22, 163, 74, 0.08);
      border: 1px solid rgba(34, 197, 94, 0.3);
      font-size: 11px;
      color: #bbf7d0;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .badge-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 10px rgba(34, 197, 94, 0.9);
    }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 0.95fr);
      gap: 18px;
    }

    @media (max-width: 830px) {
      .layout {
        grid-template-columns: 1fr;
      }
      .app {
        padding: 20px 16px 16px;
      }
    }

    .card {
      background: radial-gradient(circle at 0 0, #0b1120, #020617);
      border-radius: var(--radius-xl);
      border: 1px solid var(--border);
      padding: 18px 18px 16px;
    }

    .card + .card {
      margin-top: 8px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 12px;
    }

    .card-title {
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .card-muted {
      font-size: 12px;
      color: var(--muted);
    }

    .tabs {
      display: inline-flex;
      padding: 3px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.85);
      border: 1px solid rgba(148, 163, 184, 0.35);
      gap: 2px;
    }

    .tab {
      border: none;
      outline: none;
      padding: 6px 16px;
      font-size: 12px;
      border-radius: 999px;
      cursor: pointer;
      background: transparent;
      color: var(--muted);
      transition: all 0.18s ease-out;
    }

    .tab.active {
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      color: white;
      box-shadow: 0 10px 22px rgba(37, 99, 235, 0.4);
    }

    .form-grid {
      margin-top: 8px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .form-row {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .label {
      font-size: 12px;
      color: var(--muted);
    }

    .input {
      border-radius: 10px;
      padding: 8px 10px;
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: #020617;
      color: var(--text);
      font-size: 13px;
      outline: none;
      transition: border 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    .input::placeholder {
      color: rgba(156, 163, 175, 0.6);
    }

    .input:focus {
      border-color: rgba(59, 130, 246, 0.9);
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.65);
      background: #020617;
    }

    .btn-row {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 4px;
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 8px 16px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, #3b82f6, #2563eb);
      color: white;
      box-shadow: 0 12px 20px rgba(37, 99, 235, 0.45);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 26px rgba(37, 99, 235, 0.55);
    }

    .btn-ghost {
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: var(--muted);
    }

    .btn-ghost:hover {
      background: rgba(30, 64, 175, 0.35);
      color: #e5e7eb;
    }

    .pill {
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.45);
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .pill-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
    }

    .token-box {
      margin-top: 8px;
      padding: 10px;
      border-radius: var(--radius-md);
      background: radial-gradient(circle at 0 0, #0b1120, #020617);
      border: 1px solid rgba(37, 99, 235, 0.55);
      font-size: 11px;
      color: var(--muted);
      max-height: 105px;
      overflow: auto;
    }

    .token-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: rgba(148, 163, 184, 0.9);
      margin-bottom: 4px;
    }

    .token-value {
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo,
        Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      word-break: break-all;
      line-height: 1.4;
      color: #bfdbfe;
    }

    .status-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 4px;
    }

    .status-text {
      font-size: 11px;
      color: var(--muted);
    }

    .status-chip {
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 11px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .status-chip.ok {
      background: rgba(22, 163, 74, 0.12);
      color: #bbf7d0;
      border: 1px solid rgba(34, 197, 94, 0.6);
    }

    .status-chip.bad {
      background: rgba(220, 38, 38, 0.15);
      color: #fecaca;
      border: 1px solid rgba(248, 113, 113, 0.75);
    }

    .resp-body {
      margin-top: 8px;
      padding: 9px 10px;
      border-radius: var(--radius-md);
      background: radial-gradient(circle at 0 0, #0b1120, #020617);
      border: 1px solid rgba(55, 65, 81, 0.9);
      min-height: 70px;
      max-height: 150px;
      overflow: auto;
      font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo,
        Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 11px;
      line-height: 1.4;
      color: #e5e7eb;
      white-space: pre-wrap;
    }

    .hint {
      margin-top: 6px;
      font-size: 11px;
      color: var(--muted);
    }

    .divider {
      margin: 10px 0 6px;
      height: 1px;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(148, 163, 184, 0.5),
        transparent
      );
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    .chip-small {
      font-size: 11px;
      padding: 3px 7px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(75, 85, 99, 0.9);
      color: rgba(209, 213, 219, 0.9);
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="brand">
        <div class="brand-logo">J</div>
        <div>
          <div class="brand-text-title">AUTH SYSTEM</div>
          <div class="brand-text-sub">
            Spring Boot · JSON Web Token · Role-based access
          </div>
        </div>
      </div>

      <div class="badge">
        <span class="badge-dot"></span>
        Connected to local API (8080)
      </div>
    </header>


    <div class="layout">
      <!-- LEFT: AUTH FORMS -->
      <section class="card">
        <div class="card-header">
          <div>
            <div class="card-title">Authentication</div>
            <div class="card-muted">
              Register a user and generate a signed JSON Web Token.
            </div>
          </div>
          <div class="tabs">
            <button class="tab active" id="tab-register">Register</button>
            <button class="tab" id="tab-login">Login</button>
          </div>
        </div>

 
        <div id="register-panel" class="form-grid">
          <div class="form-row">
            <label class="label">Name</label>
            <input
              type="text"
              id="regName"
              class="input"
              placeholder="Shameem"
            />
          </div>
          <div class="form-row">
            <label class="label">Email</label>
            <input
              type="email"
              id="regEmail"
              class="input"
              placeholder="you@example.com"
            />
          </div>
          <div class="form-row">
            <label class="label">
              Password
            </label>
            <input
              type="password"
              id="regPassword"
              class="input"
              placeholder="••••••••"
            />
          </div>
          <div class="form-row">
            <label class="label">Role</label>
            <input
              type="text"
              id="regRole"
              class="input"
              placeholder="USER or ADMIN (default USER)"
            />
          </div>

          <div class="btn-row">
            <button class="btn btn-primary" id="btn-register">
              <span>Register user</span>
            </button>
          </div>
        </div>

        <div id="login-panel" class="form-grid" style="display: none">
          <div class="form-row">
            <label class="label">Email</label>
            <input
              type="email"
              id="loginEmail"
              class="input"
              placeholder="you@example.com"
            />
          </div>
          <div class="form-row">
            <label class="label">Password</label>
            <input
              type="password"
              id="loginPassword"
              class="input"
              placeholder="••••••••"
            />
          </div>

          <div class="btn-row">
            <button class="btn btn-primary" id="btn-login">
              <span>Sign in & get token</span>
            </button>
          </div>
        </div>

        <div class="divider"></div>

        <div class="chip-row">
          <span class="chip-small">POST /api/auth/register</span>
          <span class="chip-small">POST /api/auth/login</span>
          <span class="chip-small">BCrypt password hashing</span>
        </div>
      </section>

      <!-- RIGHT: TOKEN + PROTECTED CALLS -->
      <section>
        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">JWT Token</div>
              <div class="card-muted">
                Short-lived access token signed with your secret key.
              </div>
            </div>
            <span class="pill">
              <span class="pill-dot"></span>
              In-memory token
            </span>
          </div>

          <div class="token-box">
            <div class="token-label">Current token</div>
            <div id="tokenValue" class="token-value">
              No token yet. Log in to generate a JWT.
            </div>
          </div>

          <div class="status-row">
            <span class="status-text" id="tokenStatus">
              Status: not authenticated
            </span>
            <div>
              <button class="btn btn-ghost" id="btn-clear">
                Clear token
              </button>
            </div>
          </div>

          <p class="hint">
            The token is attached as
            <strong>Authorization: Bearer &lt;token&gt;</strong> when you call
            protected APIs.
          </p>
        </div>

        <div class="card">
          <div class="card-header">
            <div>
              <div class="card-title">Protected APIs</div>
              <div class="card-muted">
                Call endpoints that require a valid JWT and appropriate role.
              </div>
            </div>
          </div>

          <div class="btn-row" style="justify-content: flex-start; gap: 8px">
            <button class="btn btn-primary" id="btn-profile">
              /api/user/profile
            </button>
            <button class="btn btn-ghost" id="btn-admin">
              /api/admin/dashboard
            </button>
          </div>

          <div class="resp-body" id="responseText">
            No response yet. Try calling one of the protected endpoints.
          </div>

          <div class="status-row" style="margin-top: 6px">
            <span class="status-text">
              Response status:
              <span id="respStatusLabel">n/a</span>
            </span>
            <span class="status-chip" id="respStatusChip">
              waiting…
            </span>
          </div>

          <p class="hint">
            • <strong>200 OK</strong> → token is valid & role is allowed. <br />
            • <strong>401</strong> → missing/invalid token.
            <br />
            • <strong>403</strong> → token valid but role not allowed for route.
          </p>
        </div>
      </section>
    </div>
  </div>

  <script>
    const API_BASE = "/api"; // same origin (localhost:8080)
    let jwtToken = null;

    const tokenValueEl = document.getElementById("tokenValue");
    const tokenStatusEl = document.getElementById("tokenStatus");
    const respTextEl = document.getElementById("responseText");
    const respStatusLabelEl = document.getElementById("respStatusLabel");
    const respStatusChipEl = document.getElementById("respStatusChip");

    const tabRegister = document.getElementById("tab-register");
    const tabLogin = document.getElementById("tab-login");
    const registerPanel = document.getElementById("register-panel");
    const loginPanel = document.getElementById("login-panel");

    tabRegister.addEventListener("click", () => {
      tabRegister.classList.add("active");
      tabLogin.classList.remove("active");
      registerPanel.style.display = "flex";
      loginPanel.style.display = "none";
    });

    tabLogin.addEventListener("click", () => {
      tabLogin.classList.add("active");
      tabRegister.classList.remove("active");
      registerPanel.style.display = "none";
      loginPanel.style.display = "flex";
    });

    function setToken(token) {
      jwtToken = token;
      if (token) {
        tokenValueEl.textContent = token;
        tokenStatusEl.textContent = "Status: authenticated (token stored)";
      } else {
        tokenValueEl.textContent =
          "No token yet. Log in to generate a JWT.";
        tokenStatusEl.textContent = "Status: not authenticated";
      }
    }

    function setResponse(text, status) {
      respTextEl.textContent = text || "(empty response)";
      respStatusLabelEl.textContent = status ?? "n/a";

      if (!status) {
        respStatusChipEl.className = "status-chip";
        respStatusChipEl.textContent = "waiting…";
        return;
      }

      if (status >= 200 && status < 300) {
        respStatusChipEl.className = "status-chip ok";
        respStatusChipEl.textContent = "success";
      } else if (status === 401 || status === 403) {
        respStatusChipEl.className = "status-chip bad";
        respStatusChipEl.textContent = "unauthorized";
      } else {
        respStatusChipEl.className = "status-chip bad";
        respStatusChipEl.textContent = "error";
      }
    }

    document
      .getElementById("btn-register")
      .addEventListener("click", async () => {
        const name = document.getElementById("regName").value.trim();
        const email = document.getElementById("regEmail").value.trim();
        const password = document.getElementById("regPassword").value.trim();
        const role = document.getElementById("regRole").value.trim() || "USER";

        if (!name || !email || !password) {
          setResponse("Please fill name, email and password to register.", 0);
          return;
        }

        const body = { name, email, password, role };

        try {
          const res = await fetch(`${API_BASE}/auth/register`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(body),
          });
          const text = await res.text();
          setResponse("REGISTER (" + res.status + "): " + text, res.status);
        } catch (err) {
          setResponse("Register error: " + err, 0);
        }
      });


    document.getElementById("btn-login").addEventListener("click", async () => {
      const email = document.getElementById("loginEmail").value.trim();
      const password = document.getElementById("loginPassword").value.trim();

      if (!email || !password) {
        setResponse("Please fill email and password to login.", 0);
        return;
      }

      const body = { email, password };

      try {
        const res = await fetch(`${API_BASE}/auth/login`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body),
        });

        const token = await res.text();
        if (res.ok && token && token.length > 10) {
          setToken(token);
          setResponse("LOGIN (" + res.status + "): token received.", res.status);
        } else {
          setToken(null);
          setResponse(
            "LOGIN (" +
              res.status +
              "): did not receive a valid token. Response: " +
              token,
            res.status
          );
        }
      } catch (err) {
        setToken(null);
        setResponse("Login error: " + err, 0);
      }
    });

   
    document.getElementById("btn-clear").addEventListener("click", () => {
      setToken(null);
      setResponse("Token cleared from UI.", 0);
    });

  
    async function callProtected(path) {
      if (!jwtToken) {
        setResponse("No token available. Login first.", 0);
        return;
      }

      try {
        const res = await fetch(`${API_BASE}${path}`, {
          method: "GET",
          headers: {
            Authorization: "Bearer " + jwtToken,
          },
        });

        const text = await res.text();
        setResponse(path + " (" + res.status + "): " + text, res.status);
      } catch (err) {
        setResponse("Request error: " + err, 0);
      }
    }

   
    document
      .getElementById("btn-profile")
      .addEventListener("click", () => callProtected("/user/profile"));

   
    document
      .getElementById("btn-admin")
      .addEventListener("click", () => callProtected("/admin/dashboard"));

    setToken(null);
    setResponse("No response yet. Try registering or logging in.", 0);
  </script>
</body>
</html>
